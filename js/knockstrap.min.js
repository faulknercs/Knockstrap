/*! knockstrap 1.2.1 | (c) 2014 Artem Stepanyuk |  http://www.opensource.org/licenses/mit-license */
!function(a,b){"use strict";"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?b(require("knockout"),require("jquery")):"function"==typeof define&&define.amd?define(a,["knockout","jquery"],b):b(ko,$)}("knockstrap",function(a,b){"use strict";a.utils.uniqueId=function(){var a={"ks-unique-":0};return function(b){return b=b||"ks-unique-",a[b]||(a[b]=0),b+a[b]++}}(),a.utils.unwrapProperties=function(b){if(null===b||"object"!=typeof b)return b;var c={};return a.utils.objectForEach(b,function(b,d){c[b]=a.unwrap(d)}),c},function(){var b={};b.alert='<div class="alert fade in" data-bind="css: type, template: innerTemplate"> </div>',b.alertInner='<button class="close" data-dismiss="alert" aria-hidden="true">&times;</button> <p data-bind="text: message"></p>',b.carousel='<!-- ko template: indicatorsTemplate --> <!-- /ko --> <div class="carousel-inner"> <!-- ko foreach: items --> <div class="item" data-bind="with: $parent.converter($data), css: { active: $index() == 0 }"> <img data-bind="attr: { src: src, alt: alt }"> <div class="container"> <div class="carousel-caption"> <!-- ko template: { name: $parents[1].itemTemplateName, data: $data, templateEngine: $parents[1].templateEngine, afterRender: $parents[1].afterRender, afterAdd: $parents[1].afterAdd, beforeRemove: $parents[1].beforeRemove } --> <!-- /ko --> </div> </div> </div> <!-- /ko --> </div> <!-- ko template: controlsTemplate --> <!-- /ko --> ',b.carouselContent='<div data-bind="text: content"></div>',b.carouselControls='<a class="left carousel-control" data-bind="attr: { href: id }" data-slide="prev"> <span class="icon-prev"></span> </a> <a class="right carousel-control" data-bind="attr: { href: id }" data-slide="next"> <span class="icon-next"></span> </a>',b.carouselIndicators='<ol class="carousel-indicators" data-bind="foreach: items"> <li data-bind="attr: { \'data-target\': $parent.id, \'data-slide-to\': $index }"></li> </ol> ',b.modal='<div class="modal-dialog" data-bind="css: dialogCss"> <div class="modal-content"> <div class="modal-header" data-bind="template: headerTemplate"> </div> <div class="modal-body" data-bind="template: bodyTemplate"> </div> <!-- ko if: footerTemplate --> <div class="modal-footer" data-bind="template: footerTemplate"> </div> <!-- /ko --> </div> </div>',b.modalBody='<div data-bind="html: content"> </div>',b.modalFooter='<!-- ko if: $data.action --> <a href="#" class="btn btn-primary" data-bind="click: action, html: primaryLabel"></a> <!-- /ko --> <a href="#" class="btn btn-default" data-bind="html: closeLabel" data-dismiss="modal"></a>',b.modalHeader='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> <h3 data-bind="text: label"></h3> ',b.progress='<div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" data-bind="style: { width: barWidth }, attr: { \'aria-valuenow\': value }, css: innerCss"> <span data-bind="css: { \'sr-only\': textHidden }"> <span data-bind="text: value"></span>% <span data-bind="text: text"></span> </span> </div> ',a.templateSources.stringTemplate=function(a){this.templateName=a,this.data=function(a,c){return b.data=b.data||{},b.data[this.templateName]=b.data[this.templateName]||{},1===arguments.length?b.data[this.templateName][a]:(b.data[this.templateName][a]=c,void 0)},this.text=function(a){return 0===arguments.length?b[this.templateName]:(b[this.templateName]=a,void 0)}},a.stringTemplateEngine=function(){this.allowTemplateRewriting=!1},a.stringTemplateEngine.prototype=new a.nativeTemplateEngine,a.stringTemplateEngine.prototype.constructor=a.stringTemplateEngine,a.stringTemplateEngine.prototype.makeTemplateSource=function(b){return new a.templateSources.stringTemplate(b)},a.stringTemplateEngine.prototype.getTemplate=function(a){return b[a]},a.stringTemplateEngine.prototype.addTemplate=function(a,c){if(arguments.length<2)throw new Error("template is not provided");b[a]=c},a.stringTemplateEngine.prototype.removeTemplate=function(a){if(!a)throw new Error("template name is not provided");delete b[a]},a.stringTemplateEngine.prototype.isTemplateExist=function(a){return!!b[a]},a.stringTemplateEngine.instance=new a.stringTemplateEngine}(),a.bindingHandlers.alert={init:function(){return{controlsDescendantBindings:!0}},update:function(c,d,e,f,g){var h,i,j=b(c),k=d(),l=k.template?null:a.stringTemplateEngine.instance,m=a.unwrap(k.template)||"alertInner";if(c.nodeType===(Node.ELEMENT_NODE||1))h=m,i=k.data||{message:k.message},j.addClass("alert fade in").addClass("alert-"+(a.unwrap(k.type)||"info"));else{if(c.nodeType!==(Node.COMMENT_NODE||8))throw new Error("alert binding should be used with dom elements or ko virtual elements");h="alert",i={innerTemplate:{name:m,data:k.data||{message:k.message},templateEngine:l},type:"alert-"+(a.unwrap(k.type)||"info")}}a.renderTemplate(h,g.createChildContext(i),a.utils.extend({templateEngine:l},k.templateOptions),c)}},a.virtualElements.allowedBindings.alert=!0,a.bindingHandlers.carousel={defaults:{css:"carousel slide",controlsTemplate:{name:"carouselControls",templateEngine:a.stringTemplateEngine.instance,dataConverter:function(b){return{id:a.computed(function(){return"#"+a.unwrap(b.id)})}}},indicatorsTemplate:{name:"carouselIndicators",templateEngine:a.stringTemplateEngine.instance,dataConverter:function(b){return{id:a.computed(function(){return"#"+a.unwrap(b.id)}),items:b.content.data}}},itemTemplate:{name:"carouselContent",templateEngine:a.stringTemplateEngine.instance,converter:function(a){return a}}},init:function(c,d,e,f,g){var h=b(c),i=d(),j=a.bindingHandlers.carousel.defaults,k=function(a,c){var d={name:a.name,data:i[c]&&(i[c].data||i[c].dataConverter&&i[c].dataConverter(i))||a.dataConverter(i)};return d=b.extend(!0,{},d,i[c]),i[c]&&i[c].name||(d.templateEngine=a.templateEngine),d};if(!i.content)throw new Error("content option is required for carousel binding");c.id?i.id=c.id:c.id=i.id?a.unwrap(i.id):i.id=a.utils.uniqueId("ks-carousel-");var l={id:i.id,controlsTemplate:k(j.controlsTemplate,"controls"),indicatorsTemplate:k(j.indicatorsTemplate,"indicators"),items:i.content.data,converter:i.content.converter||j.itemTemplate.converter,itemTemplateName:i.content.name||j.itemTemplate.name,templateEngine:i.content.name?null:j.itemTemplate.templateEngine,afterRender:i.content.afterRender,afterAdd:i.content.afterAdd,beforeRemove:i.content.beforeRemove};return a.renderTemplate("carousel",g.createChildContext(l),{templateEngine:a.stringTemplateEngine.instance},c),h.addClass(j.css),{controlsDescendantBindings:!0}},update:function(c,d){var e=d(),f=a.unwrap(e.options);b(c).carousel(f)}},a.bindingHandlers.checkbox={init:function(c,d){var e=b(c),f=function(c){setTimeout(function(){var e=b(c.target),f=d(),g=e.val(),h=e.parent().hasClass("active");if(a.unwrap(f)instanceof Array){var i=a.unwrap(f).indexOf(g);h&&-1===i?f.push(g):h||-1===i||f.splice(i,1)}else f(h)},0)};if("buttons"===e.attr("data-toggle")&&e.find("input:checkbox").length){if(!(a.unwrap(d())instanceof Array))throw new Error("checkbox binding should be used only with array or observableArray values in this case");e.on("change","input:checkbox",f)}else{if("checkbox"!==e.attr("type"))throw new Error("checkbox binding should be used only with bootstrap checkboxes");if(!a.isObservable(d()))throw new Error("checkbox binding should be used only with observable values in this case");e.on("change",f)}},update:function(c,d){var e,f=b(c),g=a.unwrap(d());g instanceof Array?"buttons"===f.attr("data-toggle")?f.find("input:checkbox").each(function(a,c){e=-1!==g.indexOf(c.value),b(c).parent().toggleClass("active",e),c.checked=e}):(e=-1!==g.indexOf(f.val()),f.toggleClass("active",e),f.find("input").prop("checked",e)):(e=!!g,f.prop("checked",e),f.parent().toggleClass("active",e))}},a.bindingHandlers.modal={defaults:{css:"modal fade",dialogCss:"",attributes:{role:"dialog"},headerTemplate:{name:"modalHeader",templateEngine:a.stringTemplateEngine.instance},bodyTemplate:{name:"modalBody",templateEngine:a.stringTemplateEngine.instance},footerTemplate:{name:"modalFooter",templateEngine:a.stringTemplateEngine.instance,data:{closeLabel:"Close",primaryLabel:"Ok"}}},init:function(c,d,e,f,g){var h=b(c),i=d(),j=a.bindingHandlers.modal.defaults,k=a.utils.extend({show:h.data().show||!1},a.utils.unwrapProperties(i.options)),l=function(a,c){var d={name:a.name,data:a.data};return d=b.extend(!0,{},d,c),c&&c.name||(d.templateEngine=a.templateEngine),d};if(!i.header||!i.body)throw new Error("header and body options are required for modal binding.");(k.keyboard||"undefined"==typeof k.keyboard)&&h.attr("tabindex",-1);var m={dialogCss:i.dialogCss||j.dialogCss,headerTemplate:l(j.headerTemplate,a.unwrap(i.header)),bodyTemplate:l(j.bodyTemplate,a.unwrap(i.body)),footerTemplate:i.footer?l(j.footerTemplate,a.unwrap(i.footer)):null};return a.renderTemplate("modal",g.createChildContext(m),{templateEngine:a.stringTemplateEngine.instance},c),h.addClass(j.css).attr(j.attributes),h.modal(k),h.on("shown.bs.modal",function(){"undefined"==typeof i.visible||"function"!=typeof i.visible||a.isComputed(i.visible)||i.visible(!0),b(this).find("[autofocus]:first").focus()}),"undefined"==typeof i.visible||"function"!=typeof i.visible||a.isComputed(i.visible)||(h.on("hidden.bs.modal",function(){i.visible(!1)}),k.show&&i.visible(!0)),{controlsDescendantBindings:!0}},update:function(c,d){var e=d();"undefined"!=typeof e.visible&&b(c).modal(a.unwrap(e.visible)?"show":"hide")}};var c="__popoverTemplateKey__";a.bindingHandlers.popover={init:function(c){var d=b(c);a.utils.domNodeDisposal.addDisposeCallback(c,function(){d.data("bs.popover")&&d.popover("destroy")})},update:function(d,e,f,g,h){var i=b(d),j=a.unwrap(e()),k=(j.options||j.template?a.utils.unwrapProperties(j.options):a.utils.unwrapProperties(j))||{};if(j.template){a.unwrap(j.template);var l=a.utils.domData.get(d,c),m=a.unwrap(j.data),n=function(){a.renderTemplate(a.unwrap(j.template),h.createChildContext(m),j.templateOptions,document.getElementById(l));var c=b("#"+l).parents(".popover"),d=i.data("bs.popover"),e=d.getCalculatedOffset(k.placement||"right",d.getPosition(),c.outerWidth(),c.outerHeight());d.applyPlacement(e,k.placement||"right")};l||(l=a.utils.uniqueId("ks-popover-"),a.utils.domData.set(d,c,l),i.on("shown.bs.popover",n)),k.content='<div id="'+l+'" ></div>',k.html=!0,b("#"+l).is(":visible")&&n()}var o=i.data("bs.popover");o?a.utils.extend(o.options,k):(i.popover(k),i.on("shown.bs.popover",function(){(k.container?b(k.container):i.parent()).one("click",'[data-dismiss="popover"]',function(){i.popover("hide")})}))}},a.bindingHandlers.progress={defaults:{css:"progress",text:"",textHidden:!0,striped:!1,type:"",animated:!1},init:function(c,d){var e=b(c),f=d(),g=a.unwrap(f),h=a.bindingHandlers.progress.defaults,i=b.extend({},h,g);if("number"==typeof g)i.value=f,i.barWidth=a.computed(function(){return a.unwrap(f)+"%"});else{if("number"!=typeof a.unwrap(g.value))throw new Error('progress binding can accept only numbers or objects with "value" number propertie');i.barWidth=a.computed(function(){return a.unwrap(g.value)+"%"})}return i.innerCss=a.computed(function(){var b=a.utils.unwrapProperties(g),c="";return b.animated&&(c+="active "),b.striped&&(c+="progress-bar-striped "),b.type&&(c+="progress-bar-"+b.type),c}),a.renderTemplate("progress",i,{templateEngine:a.stringTemplateEngine.instance},c),e.addClass(h.css),{controlsDescendantBindings:!0}}},a.bindingHandlers.radio={init:function(c,d){if(!a.isObservable(d()))throw new Error("radio binding should be used only with observable values");b(c).on("change","input:radio",function(a){setTimeout(function(){var c=b(a.target),e=d(),f=c.val();e(f)},0)})},update:function(c,d){var e,f=b(c).find('input[value="'+a.unwrap(d())+'"]');f.length?(e=f.parent(),e.siblings().removeClass("active"),e.addClass("active"),f.prop("checked",!0)):(e=b(c).find(".active"),e.removeClass("active"),e.find("input").prop("checked",!1))}},a.bindingHandlers.toggle={init:function(c,d){var e=d();if(!a.isObservable(e))throw new Error("toggle binding should be used only with observable values");b(c).on("click",function(b){b.preventDefault();var c=a.unwrap(e);e(!c)})},update:function(b,c){a.utils.toggleDomNodeCssClass(b,"active",a.unwrap(c()))}},a.bindingHandlers.tooltip={init:function(c){var d=b(c);a.utils.domNodeDisposal.addDisposeCallback(c,function(){d.data("bs.tooltip")&&d.tooltip("destroy")})},update:function(c,d){var e=b(c),f=a.unwrap(d()),g=a.utils.unwrapProperties(f),h=e.data("bs.tooltip");h?a.utils.extend(h.options,g):e.tooltip(g)}}});